# FaPra OSM 2022
Repository for 'Fachpraktikum Algorithms on OpenStreetMap data' at University Stuttgart by Matthias Weilinger.<br>
This repository implements two speed up technologies. One is A Star and the second one is Contraction Hierarchies.<br>
The contraction part as well as the query part for contraction hierarchies is implemented as described in the paper <br>
```Contraction Hierarchies: Faster and Simpler Hierarchical Routing in Road Networks by Geisberger et al.```

# Instructions
### Install Golang
At first, you have to install golang on your System.<br>
Version 1.18 is recommended.<br>
For ubuntu you can follow [this](https://cmatskas.com/install-go-on-wsl-ubuntu-from-the-command-line/) blog post.
### Generate FMI file from PBF file
    1. Navigate into the project folder, so that you are in the directory OSM.
    2. Build the project with command: go build ./src/main.go
    3. Run project with command: ./main {pathToPbfFile}
    4. You can find the resulting fmi file in the same direcory as your pbf file.

### Contract a graph to use it for Contraction Hierarchies
    Important Notice: Contracting may take several hours depending on the machine it is running on.
    An already contracted version of the 1-million-node graph is provided in this repo in ./out/graphContracted.fmi.
    1. You need a file that holds a graph in the fmi format
    2. Navigate into the project folder, so that you are in the directory OSM.
    3. Build the project with command: go build ./src/contractGraph.go
    4. Run project with command: ./contractGraph {pathToGraphFmi}
    5. You can find the resulting fmi file with the contracted graph in the same direcory as your fmi file.

### Benchmark all implemented speedup technologies
    1. You need two files, one should hold a graph in the fmi format 
        and one should hold acontracted version of that graph as generated by the method explaiend above.
    2. Navigate into the project folder, so that you are in the directory OSM.
    3. Build the project with command: go build ./src/bench.go
    4. Run project with command: ./bench {pathToGraphFmi} {pathToContractedGraphFmi}
    5. You will get csv files with the benchmarks of all implemented speed up technologies.
    The first columns of a csv holds the time spent to find the shortest path in microsedonds, 
    the second column holds the heap pulls used to find the shortest path.






### Run Webserver
    1. Navigate into the project folder, so that you are in the directory OSM.
    2. Build the project with command: go build ./src/mainWeb.go
    3. Run project with command: ./mainWeb {pathToFmiFile}
    4. The GUI can be found at localhost/8081

### How to use GUI
    - In your browser navigate to localhost/8081
    - To set a starting point just click anywhere on the map
    - To create a ending point click anywhere on the map
    - Both points will snap to the closest point in water that was created in Task 3
    - Immediately after setting a ending point a shortest path will be drawn on the map
    - When clicking on the marker or on the line more information will be displayed
    - To plan a new route just click anywhere on the map and a new starting point will be set